{% extends 'base.html' %}

{% block content %}
{% if request.GET.q %}
<!-- Search Results Section -->
<div class="container py-5">
    <h2 class="mb-4">Search Results for "{{ request.GET.q }}"</h2>
    
    {% if not clubs and not upcoming_events %}
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>No results found. Try different keywords or browse all clubs and events.
        </div>
    {% endif %}
    
    {% if clubs %}
    <h3 class="mb-3">Matching Clubs</h3>
    <div class="row g-4 mb-5">
        {% for club in clubs %}
        <div class="col-md-4 animate__animated animate__fadeIn">
            <div class="card h-100">
                {% if club.image %}
                    <img src="{{ club.image.url }}" class="card-img-top" alt="{{ club.name }}">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ club.name }}</h5>
                    <p class="card-text">{{ club.description|truncatewords:20 }}</p>
                    <div class="d-grid gap-2">
                        <a href="{% url 'club_detail' club.id %}" class="btn btn-primary">
                            <i class="fas fa-info-circle me-1"></i>Learn More
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if upcoming_events %}
    <h3 class="mb-3">Matching Events</h3>
    <div class="row g-4">
        {% for event in upcoming_events %}
        <div class="col-md-6 animate__animated animate__fadeIn">
            <div class="card h-100">
                {% if event.image %}
                    <img src="{{ event.image.url }}" class="card-img-top" alt="{{ event.title }}">
                {% endif %}
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div>
                            <h5 class="card-title mb-1">{{ event.title }}</h5>
                            <p class="text-muted mb-0">{{ event.club.name }}</p>
                        </div>
                        <div class="event-date">
                            <div class="day">{{ event.date|date:"d" }}</div>
                            <div class="month">{{ event.date|date:"M" }}</div>
                        </div>
                    </div>
                    <p class="card-text">{{ event.description|truncatewords:30 }}</p>
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">{{ event.location }}</small>
                        <a href="{% url 'event_detail' event.id %}" class="btn btn-primary">
                            <i class="fas fa-calendar-alt me-1"></i>Details
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% else %}
<!-- Hero Section -->
<section class="hero-section text-light text-center py-5 animate__animated animate__fadeIn">
    <div class="container">
        <h1 class="display-4 mb-4">Welcome to College Hub</h1>
        <p class="lead mb-4">Discover exciting clubs and events at your college!</p>
        <div class="d-flex justify-content-center gap-3">
            <a href="{% url 'club_list' %}" class="btn btn-light btn-lg">
                <i class="fas fa-users me-2"></i>Browse Clubs
            </a>
            <a href="{% url 'event_list' %}" class="btn btn-outline-light btn-lg">
                <i class="fas fa-calendar-alt me-2"></i>View Events
            </a>
        </div>
    </div>
</section>

    <style>
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-outline-primary {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 25px;
            padding: 8px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .club-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        .event-date {
            background: linear-gradient(45deg, var(--accent-color), #f97316);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }

        .stats-card {
            background: linear-gradient(45deg, var(--success-color), #059669);
            color: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
        }

        .search-box {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50px;
            padding: 15px 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .category-filter {
            padding: 8px 20px;
            margin: 5px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            color: var(--primary-color);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .category-filter:hover, .category-filter.active {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .modal-content {
            border-radius: 20px;
            border: none;
        }

        .modal-header {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 20px 20px 0 0;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-day:hover {
            background: var(--primary-color);
            color: white;
        }

        .calendar-day.has-event {
            background: var(--accent-color);
            color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#" style="color: var(--primary-color);">
                <i class="fas fa-graduation-cap me-2"></i>College Hub
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#clubs">Clubs</a></li>
                    <li class="nav-item"><a class="nav-link" href="#events">Events</a></li>
                    <li class="nav-item"><a class="nav-link" href="#calendar">Calendar</a></li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#loginModal">
                        <i class="fas fa-sign-in-alt me-1"></i>Login
                    </button>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#registerModal">
                        <i class="fas fa-user-plus me-1"></i>Register
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <section id="home" class="hero-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center fade-in">
                    <h1 class="display-4 fw-bold mb-4">Connect. Engage. Excel.</h1>
                    <p class="lead mb-4">Join clubs, attend events, and make your college experience memorable.</p>
                    <div class="d-flex justify-content-center gap-3">
                        <button class="btn btn-primary btn-lg" onclick="scrollToSection('clubs')">
                            <i class="fas fa-users me-2"></i>Explore Clubs
                        </button>
                        <button class="btn btn-outline-light btn-lg" onclick="scrollToSection('events')">
                            <i class="fas fa-calendar me-2"></i>View Events
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-5">
        <div class="container">
            <div class="row g-4">
                <div class="col-md-3"><div class="stats-card"><h3 class="display-6 fw-bold mb-2">45+</h3><p class="mb-0">Active Clubs</p></div></div>
                <div class="col-md-3"><div class="stats-card"><h3 class="display-6 fw-bold mb-2">120+</h3><p class="mb-0">Upcoming Events</p></div></div>
                <div class="col-md-3"><div class="stats-card"><h3 class="display-6 fw-bold mb-2">2,500+</h3><p class="mb-0">Active Members</p></div></div>
                <div class="col-md-3"><div class="stats-card"><h3 class="display-6 fw-bold mb-2">15+</h3><p class="mb-0">Categories</p></div></div>
            </div>
        </div>
    </section>

    <section id="clubs" class="py-5">
        <div class="container">
            <div class="row mb-5">
                <div class="col-12 text-center">
                    <h2 class="display-5 fw-bold mb-4" style="color: white;">Explore Clubs</h2>
                    <div class="row justify-content-center mb-4">
                        <div class="col-md-6">
                            <input type="text" class="form-control search-box" placeholder="Search clubs..." id="clubSearch">
                        </div>
                    </div>
                    <div class="text-center mb-4">
                        <a href="#" class="category-filter active" data-category="all">All</a>
                        <a href="#" class="category-filter" data-category="academic">Academic</a>
                        <a href="#" class="category-filter" data-category="sports">Sports</a>
                        <a href="#" class="category-filter" data-category="cultural">Cultural</a>
                        <a href="#" class="category-filter" data-category="technical">Technical</a>
                        <a href="#" class="category-filter" data-category="social">Social</a>
                    </div>
                </div>
            </div>
            <div class="row g-4" id="clubsContainer"></div>
        </div>
    </section>

    <section id="events" class="py-5">
        <div class="container">
            <div class="row mb-5">
                <div class="col-12 text-center">
                    <h2 class="display-5 fw-bold mb-4" style="color: white;">Upcoming Events</h2>
                    <div class="row justify-content-center mb-4">
                        <div class="col-md-6">
                            <input type="text" class="form-control search-box" placeholder="Search events..." id="eventSearch">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row g-4" id="eventsContainer"></div>
        </div>
    </section>

    <section id="calendar" class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="card">
                        <div class="card-header bg-primary text-white text-center">
                            <h3 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Event Calendar - June 2025</h3>
                        </div>
                        <div class="card-body">
                            <div class="calendar-grid" id="calendarGrid"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-sign-in-alt me-2"></i>Login</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Login</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Register</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="firstName" class="form-label">First Name</label>
                                <input type="text" class="form-control" id="firstName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="lastName" class="form-label">Last Name</label>
                                <input type="text" class="form-control" id="lastName" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="studentId" class="form-label">Student ID</label>
                            <input type="text" class="form-control" id="studentId" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="department" class="form-label">Department</label>
                                <select class="form-select" id="department" required>
                                    <option value="">Select Department</option>
                                    <option value="computer-science">Computer Science</option>
                                    <option value="engineering">Engineering</option>
                                    <option value="business">Business</option>
                                    <option value="arts">Arts</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="year" class="form-label">Year</label>
                                <select class="form-select" id="year" required>
                                    <option value="">Select Year</option>
                                    <option value="1st">1st Year</option>
                                    <option value="2nd">2nd Year</option>
                                    <option value="3rd">3rd Year</option>
                                    <option value="4th">4th Year</option>
                                    <option value="graduate">Graduate</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm Password</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Register</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Clubs Section -->
<section class="py-5 animate__animated animate__fadeIn">
    <div class="container">
        <h2 class="text-center mb-4">Featured Clubs</h2>
        <div class="row g-4">
            {% for club in clubs %}
            <div class="col-md-4">
                <div class="card h-100">
                    {% if club.image %}
                        <img src="{{ club.image.url }}" class="card-img-top" alt="{{ club.name }}">
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title">{{ club.name }}</h5>
                        <p class="card-text">{{ club.description|truncatewords:20 }}</p>
                        <a href="{% url 'club_detail' club.id %}" class="btn btn-primary">
                            <i class="fas fa-info-circle me-1"></i>Learn More
                        </a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center">
                <p>No clubs available at the moment.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Upcoming Events Section -->
<section class="py-5 bg-light animate__animated animate__fadeIn">
    <div class="container">
        <h2 class="text-center mb-4">Upcoming Events</h2>
        <div class="row g-4">
            {% for event in upcoming_events %}
            <div class="col-md-6">
                <div class="card h-100">
                    {% if event.image %}
                        <img src="{{ event.image.url }}" class="card-img-top" alt="{{ event.title }}">
                    {% endif %}
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h5 class="card-title mb-1">{{ event.title }}</h5>
                                <p class="text-muted mb-0">{{ event.club.name }}</p>
                            </div>
                            <div class="event-date">
                                <div class="day">{{ event.date|date:"d" }}</div>
                                <div class="month">{{ event.date|date:"M" }}</div>
                            </div>
                        </div>
                        <p class="card-text">{{ event.description|truncatewords:30 }}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">{{ event.location }}</small>
                            <a href="{% url 'event_detail' event.id %}" class="btn btn-primary">
                                <i class="fas fa-calendar-alt me-1"></i>Details
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center">
                <p>No upcoming events at the moment.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample data
        const clubs = [
            { id: 1, name: "Computer Science Society", category: "technical", description: "A community for CS students to collaborate on projects and participate in coding competitions.", members: 120, president: "Alex Johnson", image: "https://via.placeholder.com/300x200/2563eb/ffffff?text=CS+Society" },
            { id: 2, name: "Drama Club", category: "cultural", description: "Express your creativity through theatrical performances and workshops.", members: 85, president: "Sarah Wilson", image: "https://via.placeholder.com/300x200/f59e0b/ffffff?text=Drama+Club" },
            { id: 3, name: "Basketball Team", category: "sports", description: "Join our competitive basketball team and represent the college in tournaments.", members: 25, president: "Mike Davis", image: "https://via.placeholder.com/300x200/10b981/ffffff?text=Basketball" },
            { id: 4, name: "Debate Society", category: "academic", description: "Enhance your public speaking and critical thinking skills through debates.", members: 95, president: "Emma Thompson", image: "https://via.placeholder.com/300x200/ef4444/ffffff?text=Debate+Society" },
            { id: 5, name: "Environmental Club", category: "social", description: "Promote sustainability and environmental awareness on campus.", members: 150, president: "Green Leader", image: "https://via.placeholder.com/300x200/059669/ffffff?text=Environment" },
            { id: 6, name: "Photography Club", category: "cultural", description: "Capture moments and learn photography techniques with enthusiasts.", members: 75, president: "Photo Master", image: "https://via.placeholder.com/300x200/8b5cf6/ffffff?text=Photography" }
        ];

        const events = [
            { id: 1, title: "Tech Conference 2025", date: "2025-06-15", time: "10:00 AM", location: "Main Auditorium", club: "Computer Science Society", description: "Annual technology conference featuring industry speakers.", registrations: 150, maxRegistrations: 200 },
            { id: 2, title: "Summer Drama Festival", date: "2025-06-20", time: "7:00 PM", location: "College Theater", club: "Drama Club", description: "Three-day drama festival showcasing student performances.", registrations: 85, maxRegistrations: 100 },
            { id: 3, title: "Basketball Championship", date: "2025-06-25", time: "2:00 PM", location: "Sports Complex", club: "Basketball Team", description: "Annual basketball tournament with multiple colleges.", registrations: 8, maxRegistrations: 12 },
            { id: 4, title: "National Debate Competition", date: "2025-06-18", time: "9:00 AM", location: "Conference Hall", club: "Debate Society", description: "Prestigious debate competition with universities nationwide.", registrations: 32, maxRegistrations: 40 },
            { id: 5, title: "Earth Day Cleanup Drive", date: "2025-06-22", time: "8:00 AM", location: "Campus Grounds", club: "Environmental Club", description: "Community service event to clean up campus.", registrations: 120, maxRegistrations: null },
            { id: 6, title: "Photography Workshop", date: "2025-06-28", time: "2:00 PM", location: "Art Studio", club: "Photography Club", description: "Hands-on workshop covering advanced photography techniques.", registrations: 45, maxRegistrations: 50 }
        ];

        // Utility functions
        const scrollToSection = (sectionId) => {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        };

        const showToast = (message, type = 'success') => {
            const toast = document.createElement('div');
            toast.className = `toast align-items-center text-white bg-${type} border-0 position-fixed bottom-0 end-0 m-3`;
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            document.body.appendChild(toast);
            new bootstrap.Toast(toast).show();
            setTimeout(() => toast.remove(), 3000);
        };

        // Render functions
        const renderClubs = (clubsToRender = clubs) => {
            const container = document.getElementById('clubsContainer');
            container.innerHTML = clubsToRender.map(club => `
                <div class="col-lg-4 col-md-6 fade-in">
                    <div class="card club-card h-100">
                        <img src="${club.image}" class="card-img-top" alt="${club.name}" style="height: 200px; object-fit: cover;">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${club.name}</h5>
                            <span class="badge bg-primary mb-2 align-self-start">${club.category.charAt(0).toUpperCase() + club.category.slice(1)}</span>
                            <p class="card-text flex-grow-1">${club.description}</p>
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <small class="text-muted"><i class="fas fa-users me-1"></i>${club.members} members</small>
                                    <small class="text-muted"><i class="fas fa-crown me-1"></i>${club.president}</small>
                                </div>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="joinClub(${club.id})"><i class="fas fa-plus me-1"></i>Join Club</button>
                                    <button class="btn btn-outline-primary" onclick="viewClub(${club.id})"><i class="fas fa-eye me-1"></i>View Details</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        };

        const renderEvents = (eventsToRender = events) => {
            const container = document.getElementById('eventsContainer');
            container.innerHTML = eventsToRender.map(event => {
                const eventDate = new Date(event.date);
                const day = eventDate.getDate();
                const month = eventDate.toLocaleDateString('en-US', { month: 'short' });
                return `
                    <div class="col-lg-6 col-md-6 fade-in">
                        <div class="card event-card h-100">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-3">
                                        <div class="event-date">
                                            <div class="fs-4 fw-bold">${day}</div>
                                            <div class="fs-6">${month}</div>
                                        </div>
                                    </div>
                                    <div class="col-9">
                                        <h5 class="card-title">${event.title}</h5>
                                        <p class="card-text">${event.description}</p>
                                        <div class="mb-2">
                                            <small class="text-muted"><i class="fas fa-clock me-1"></i>${event.time} | <i class="fas fa-map-marker-alt me-1"></i>${event.location}</small>
                                        </div>
                                        <div class="mb-2">
                                            <small class="text-muted"><i class="fas fa-users me-1"></i>By ${event.club}</small>
                                        </div>
                                        <div class="mb-3">
                                            <small class="text-muted"><i class="fas fa-user-check me-1"></i>Registered: ${event.registrations}${event.maxRegistrations ? '/' + event.maxRegistrations : ''}</small>
                                        </div>
                                        <div class="d-grid gap-2">
                                            <button class="btn btn-success" onclick="registerEvent(${event.id})"><i class="fas fa-calendar-plus me-1"></i>Register</button>
                                            <button class="btn btn-outline-primary" onclick="viewEvent(${event.id})"><i class="fas fa-info-circle me-1"></i>More Info</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        };

        const renderCalendar = () => {
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = `
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Sun</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Mon</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Tue</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Wed</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Thu</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Fri</div>
                <div class="fw-bold text-center p-2" style="color: var(--primary-color);">Sat</div>
            `;

            const today = new Date(2025, 5, 1); // June 2025
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1).getDay();
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) {
                calendarGrid.innerHTML += '<div class="calendar-day"></div>';
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dayEvents = events.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate.getDate() === day && eventDate.getMonth() === today.getMonth();
                });

                const classes = `calendar-day${dayEvents.length ? ' has-event' : ''}`;
                const tooltip = dayEvents.length ? `title="${dayEvents.map(e => e.title).join('\n')}"` : '';
                calendarGrid.innerHTML += `
                    <div class="${classes}" ${tooltip} onclick="showDayEvents(${day})">
                        ${day}
                        ${dayEvents.length ? `<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">${dayEvents.length}</span>` : ''}
                    </div>
                `;
            }
        };

        // Event handlers
        const joinClub = (clubId) => {
            const club = clubs.find(c => c.id === clubId);
            showToast(`Successfully joined ${club.name}!`, 'success');
        };

        const viewClub = (clubId) => {
            const club = clubs.find(c => c.id === clubId);
            alert(`Viewing details for ${club.name}\nCategory: ${club.category}\nMembers: ${club.members}\nPresident: ${club.president}\n${club.description}`);
        };

        const registerEvent = (eventId) => {
            const event = events.find(e => e.id === eventId);
            if (event.maxRegistrations && event.registrations >= event.maxRegistrations) {
                showToast('Event is fully booked!', 'danger');
                return;
            }
            event.registrations++;
            renderEvents();
            showToast(`Registered for ${event.title}!`, 'success');
        };

        const viewEvent = (eventId) => {
            const event = events.find(e => e.id === eventId);
            alert(`Viewing details for ${event.title}\nDate: ${event.date}\nTime: ${event.time}\nLocation: ${event.location}\nClub: ${event.club}\n${event.description}`);
        };

        const showDayEvents = (day) => {
            const dayEvents = events.filter(e => new Date(e.date).getDate() === day);
            if (dayEvents.length) {
                alert(`Events on June ${day}, 2025:\n${dayEvents.map(e => `${e.title} (${e.time})`).join('\n')}`);
            }
        };

        // Search and filter
        document.getElementById('clubSearch').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filteredClubs = clubs.filter(club => club.name.toLowerCase().includes(searchTerm));
            renderClubs(filteredClubs);
        });

        document.getElementById('eventSearch').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filteredEvents = events.filter(event => event.title.toLowerCase().includes(searchTerm));
            renderEvents(filteredEvents);
        });

        document.querySelectorAll('.category-filter').forEach(filter => {
            filter.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.category-filter').forEach(f => f.classList.remove('active'));
                filter.classList.add('active');
                
                const category = filter.dataset.category;
                const filteredClubs = category === 'all' ? clubs : clubs.filter(club => club.category === category);
                renderClubs(filteredClubs);
            });
        });

        // Form submissions
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            showToast('Login successful!', 'success');
            bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
        });

        document.getElementById('registerForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                showToast('Passwords do not match!', 'danger');
                return;
            }
            
            showToast('Registration successful!', 'success');
            bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
        });

        // Initialize
        renderClubs();
        renderEvents();
        renderCalendar();
    </script>
</body>
</html>